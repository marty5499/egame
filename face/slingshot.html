<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <script src='./lib/jquery-1.11.0.min.js'></script>
    <script src="./lib/camera.js"></script>
    <script src="./lib/faceDetect.js"></script>
    <script src="./lib/decomp.js"></script>
    <script src="./lib/pathseg.js"></script>
    <script src="./lib/matter.js"></script>
    <script src='./waMatter.js'></script>
    <style>
        .button {
            background-color: #4CAF50;
            /* Green */
            border: none;
            color: white;
            padding: 15px 32px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 2em;
        }
    </style>
</head>

<body>
    <div id='m' width=800 height=600></div>
    <div id='btn' class='button'>Fire</div>
</body>
<script>
    class Slingshot {
        constructor(world, x, y, n, r) {
            var self = this;
            this.world = world;
            this.rock = world.addPolygon(x, y, n, r, {
                density: 0.05
            });
            this.elastic = world.addElastic(self.rock, x, y, 0.1);
            world.addEvent(function() {
                if (self.rock.position.y < y - 5) {
                    self.rock = world.addPolygon(x, y, n, r, {
                        density: 0.05
                    });
                    self.elastic.bodyB = self.rock;
                }
            });
        }

        move(x, y) {
            if (this.y < y) return;
            this.rock.isStatic = true;
            this.world.move(this.rock, x, y);
        }

        fire() {
            this.rock.isStatic = false;
        }
    }


    var world = new waMatter(m, 800, 600).init().run();
    var slingshot = new Slingshot(world, 170, 350, 6, 24);

    btn.addEventListener("mousedown", function() {
        slingshot.move(140, 400);
    });

    btn.addEventListener("mouseup", function() {
        slingshot.fire();
    });
</script>


</html>